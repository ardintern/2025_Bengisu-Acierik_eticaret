@using EcommerceWebSite.Entity         @* EnumOrderState için *@
@model EcommerceWebSite.Models.OrderDetailsModel

@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container pb-5">
    <h2>Sipariş Detay Bilgileri</h2>
    <hr />

    @if (TempData["message"] is string msg)
    {
        <div class="alert alert-success">@msg</div>
    }

    <dl class="row">
        <dt class="col-sm-3">Username</dt>
        <dd class="col-sm-9">@Model.UserName</dd>

        <dt class="col-sm-3">Order State</dt>
        <dd class="col-sm-9">
            <form asp-controller="Order" asp-action="UpdateOrderState" method="post" class="row g-2">
                @Html.AntiForgeryToken()
                <input type="hidden" name="orderId" value="@Model.OrderId" />
                <div class="col-sm-8">
                    <select asp-for="OrderState"
                            asp-items="Html.GetEnumSelectList<EnumOrderState>()"
                            class="form-select">
                        <option value="">Select Order State</option>
                    </select>
                </div>
                <div class="col-sm-4">
                    <button type="submit" class="btn btn-primary">Update</button>
                </div>
            </form>
        </dd>

        <dt class="col-sm-3">Order Id</dt>
        <dd class="col-sm-9">@Model.OrderId</dd>

        <dt class="col-sm-3">Order Number</dt>
        <dd class="col-sm-9">@Model.OrderNumber</dd>

        <dt class="col-sm-3">Total</dt>
        <dd class="col-sm-9">@Model.Total.ToString("c")</dd>

        <dt class="col-sm-3">Order Date</dt>
        <dd class="col-sm-9">@Model.OrderDate.ToString("g")</dd>

        <dt class="col-sm-3">Adres</dt>
        <dd class="col-sm-9">
            @Model.AdresBasligi
            <hr class="my-2" />
            @Model.Adres<br />
            @Model.Sehir - @Model.Semt - @Model.Mahalle<br />
            @Model.PostaKodu
        </dd>

        <dt class="col-sm-3">Products</dt>
        <dd class="col-sm-9">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th style="width:45%;">Product Name</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th style="width:10%;"></th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var item in Model.Orderlines)
                {
                    <tr>
                        <td>
                            @if (!string.IsNullOrWhiteSpace(item.Image))
                            {
                                <img src="~/Upload/@item.Image" width="70" />
                            }
                        </td>
                        <td>@item.ProductName</td>
                        <td>@item.Quantity</td>
                        <td>@item.Price.ToString("c")</td>
                        <td class="text-nowrap">
                            <a asp-controller="Home"
                               asp-action="Details"
                               asp-route-id="@item.ProductId"
                               target="_blank"
                               class="btn btn-primary btn-sm">
                                <i class="fa fa-angle-double-right" aria-hidden="true"></i>
                                Product Details
                            </a>
                        </td>
                    </tr>
                }
                </tbody>
            </table>
        </dd>
    </dl>
</div>
